<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>utils/EnviarCorreos.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <li class="nav-link nav-home-link"><a href="index.html">Home</a></li><li class="nav-heading">Classes</li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="CurricularController.html">CurricularController</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="CurricularModel.html">CurricularModel</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="FormatResponseController.html">FormatResponseController</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="FormatResponseModel.html">FormatResponseModel</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="HorarioController.html">HorarioController</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="ProfesorController.html">ProfesorController</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="UserController.html">UserController</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="UserModel.html">UserModel</a></span></li><li class="nav-heading">Modules</li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-ProfesorModel.html">ProfesorModel</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-ProfesorModel.html#.RegisterProfesor">RegisterProfesor</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-ProfesorModel.html#.buscarProfesor">buscarProfesor</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-ProfesorModel.html#.mostrarProfesor">mostrarProfesor</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-ProfesorModel.html#.mostrarProfesorAPI">mostrarProfesorAPI</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-emailService.html">emailService</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-emailService.html#~enviarEmail">enviarEmail</a></span></li><li class="nav-heading"><span class="nav-item-type type-module">M</span><span class="nav-item-name"><a href="module-passwordUtils.html">passwordUtils</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-passwordUtils.html#~comparePassword">comparePassword</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-passwordUtils.html#~generarPassword">generarPassword</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="module-passwordUtils.html#~hashPassword">hashPassword</a></span></li><li class="nav-heading"><a href="global.html">Globals</a></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html">buscarProfesor</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#generateReport">generateReport</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html">login</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html">loginUser</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html">mostrarPNF</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html">mostrarPostGrados</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html">mostrarPreGrados</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html">mostrarProfesor</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html">mostrarProfesorAPI</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html">mostrarTrayectos</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html">mostrarUnTrayecto</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html">registrarHorario</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#registrarHorario-Registraunnuevohorarioenlabasededatos">registrarHorario - Registra un nuevo horario en la base de datos</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html">registrarPNF</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html">registrarProfesor</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html">registrarUnidadCurricular</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html">regitrarPNF</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html">regitrarUnidadCurricular</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html">respuestaDatos</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html">respuestaError</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html">respuestaExito</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html">respuestaPostgres</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html">respuestaSuccess</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html">validacionesComunes</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html#validationErrors">validationErrors</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="global.html">verificarUsers</a></span></li>
</nav>

<div id="main">
    
    <h1 class="page-title">utils/EnviarCorreos.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @module emailService
 * @description Módulo para el envío de correos electrónicos utilizando nodemailer.
 * Proporciona funciones para enviar emails con plantillas HTML y manejo de adjuntos.
 * @requires nodemailer
 */

import nodemailer from "nodemailer";

import path from 'path';
import { fileURLToPath } from 'url';
import fs from 'fs';

// Configuración de rutas absolutas
const __filename = fileURLToPath(import.meta.url);
const __dirname = path.dirname(__filename);
const logoPath = path.join(__dirname, 'logo.png'); // Ajusta esta ruta

// Verificación de existencia
if (!fs.existsSync(logoPath)) {
  throw new Error(`Archivo logo.png no encontrado en: ${logoPath}`);
}

/**
 * @constant {Object} EMAIL_CONFIG
 * @description Configuración básica para el servicio de correo electrónico
 * @property {string} user - Correo electrónico del remitente
 * @property {string} pass - Contraseña de aplicación generada en Gmail
 */
const EMAIL_CONFIG = {
  user: "delegadogabrielleonett@gmail.com",
  pass: "eufe wcxu ltpu vzgh" // Debería reemplazarse por variables de entorno en producción
};

const año = new Date();

/**
 * @async
 * @function enviarEmail
 * @description Envía un correo electrónico utilizando nodemailer con plantilla HTML
 * @param {Object} params - Objeto con parámetros de envío
 * @param {string} params.Destinatario - Dirección de correo del destinatario
 * @param {Object} params.Correo - Configuración específica del correo
 * @param {string} params.Correo.asunto - Asunto del correo electrónico
 * @param {string} params.Correo.html - Contenido HTML del cuerpo del correo
 * @returns {Promise&lt;void>} No retorna valor pero puede lanzar errores
 * @throws {Error} Cuando falla el envío del correo
 * 
 * @example
 * await enviarEmail({
 *   Destinatario: 'destinatario@example.com',
 *   Correo: {
 *     asunto: 'Asunto importante',
 *     html: '&lt;p>Contenido del correo&lt;/p>'
 *   }
 * });
 */
export async function enviarEmail({ Destinatario, Correo }) {
  /**
   * @type {nodemailer.Transporter}
   * @description Configuración del transporte para nodemailer usando servicio Gmail
   */
  const transporter = nodemailer.createTransport({
    service: "gmail",
    auth: {
      user: EMAIL_CONFIG.user,
      pass: EMAIL_CONFIG.pass
    }
  });

  /**
   * @type {nodemailer.SendMailOptions}
   * @description Opciones del correo electrónico con plantilla HTML estructurada
   */
  const mailOptions = {
    from: EMAIL_CONFIG.user,
    to: Destinatario,
    subject: Correo.asunto,
    html: `
      &lt;div style="font-family: Poppins, sans-serif; max-width: 600px; margin: 0 auto;">
          &lt;header style="background-color: #1C75BA; padding: 20px; text-align: center;">
              &lt;img src="cid:logo" alt="Logo UPTAMCA" style="width: 100px;">
          &lt;/header>

          &lt;div style="padding: 20px;">
            ${Correo.html}
            &lt;p style="color: #7f8c8d; font-size: 0.9em; border-top: 1px solid #eee; padding-top: 15px;">
                      Este mensaje está dirigido exclusivamente al destinatario. Si usted no es la persona
                      a quien va dirigido, le solicitamos eliminarlo y notificarlo al remitente.
            &lt;/p>
          &lt;/div>
          &lt;div style="display: flex; flex-direction: row; justify-content: center; align-items: center; width: 100%;">
              &lt;a href="http://localhost:5173/login" style="display: inline-block; background-color: #1C75BA; color: white; 
                        padding: 10px 20px; text-decoration: none; border-radius: 5px; margin-bottom: 20px;">
                  Acceder a la plataforma
              &lt;/a>
          &lt;/div>
          &lt;footer style="background-color: #f3f4f6; padding: 15px; text-align: center; font-size: 12px;">
              © ${año.getUTCFullYear()} UPTAMCA. Todos los derechos reservados.
          &lt;/footer>
      &lt;/div>
        `, // Cuerpo del correo en formato HTML
    attachments: [{
      filename: 'logo.png',
      path: logoPath, // Ruta a tu archivo local
      cid: 'logo' // mismo ID que usas en el HTML
    }]
  };

  try {
    await transporter.sendMail(mailOptions);
  } catch (error) {
    throw "Error al enviar el correo electrónico";
  }
}

/**
 * @description Consideraciones de seguridad importantes para el módulo de correo:
 * 1. Las credenciales deberían manejarse mediante variables de entorno en producción
 * 2. Gmail tiene límites de envío (500 correos/día para cuentas estándar)
 * 3. Para producción considerar servicios especializados como SendGrid o Mailgun
 * 4. Nunca incluir contraseñas directamente en el código fuente
 * 5. Implementar mecanismos de reintento para fallos temporales
 */</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.4</a> on Thu Jul 31 2025 12:10:09 GMT-0400 (hora de Venezuela) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
